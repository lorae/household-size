---
title: "Test title"
output: 
  html_document:
    mathjax: "default"
---



```{r init, include = FALSE}
library(ggplot2)
library(patchwork)
```

As shown in the documentation for this project, it is possible to have the same summary statistics but different underlying household configurations.



For every person \( j \) in a population \( P \) living in a household of \( m_j \) members, the **person-level** mean household size is a simple average across person-level observations:

\begin{align}
\text{(Mean HH Size)}_{\text{person}}
= \frac{\sum_{j = 1}^P m_j}{\sum_{i = 1}^H m_i}
= \frac{\sum_{j = 1}^P m_j}{P}
\end{align}

For every household \( i \) with number of members \( m_i \) in households \( 1 \) through \( H \), the **household-level** mean household size is a simple average across households as individual observations:

\begin{align}
\text{(Mean HH Size)}_{\text{household}} 
= \frac{\sum_{i = 1}^H m_i}{H} 
= \frac{P}{H}
\end{align}

We have:

- population size
- average household size

We want to know 

- number of households

Proof: although household-level average household size is perfectly determinate in this regard, person-level household size in conjunction with population size can also be used to come up with a minimum and maximum bound on number of households.

Since 
\begin{align}
\text{(Mean HH Size)}_{\text{household}} 
= \frac{P}{H}
\end{align}

\begin{align}
H = \frac{P}{\text{(Mean HH Size)}_{\text{household}}}
\end{align}

However, household-level household size doesn't lend itself to this equivalency. In fact, given population size and person-level average household size, there are potentially more than one value of number of household consistent with the first two facts. Consider the following counterexample. There is a population of 6 individuals. The average person-level household size is 3. 

Figure 1.2 shows two hypothetical Americas consistent with the summary statistics. In scenario 1, average person-level household size is
\\[ 
\\frac{3+3+3 + 3+3+3}{6} = 3
\\]

While in scenario 2, average person-level household size is
\\[ 
\\frac{1 + 1 + 4+4+4+4}{6} = 3
\\]
  
  
However, in Scenario 1, there are two households, while in scenario 3, there are 3 households. Thus, person-level household size and population are not always adequate to precisely estimate number of households.

**Figure 1.2**
```{r fig01.2, echo=FALSE, out.width="100%"}

# Define plot height factor (adjustable)
plot_height <- 1  

# Data for Scenario 1
hh_data1 <- data.frame(
  hh_id = rep(c("Household A", "Household B"), times = c(3, 3)),
  x = c(1, 2, 1.5, 1, 2, 1.5),
  y = c(1, 1, 2, 1, 1, 2)
)

# Data for Scenario 2
hh_data2 <- data.frame(
  hh_id = rep(c("Household A", "Household B", "Household C"), times = c(1, 1, 4)),
  x = c(1.5, 1.5, 1, 1, 2, 2),
  y = c(1.5, 1.5, 1, 2, 1, 2)
)

# Plot for Scenario 1
plot1 <- ggplot(hh_data1, aes(x = x, y = y)) +
  geom_point(shape = 21, size = 4 * plot_height, color = "black", stroke = 1.2 * plot_height) +
  theme_void(base_size = 10 * plot_height) +
  theme(plot.margin = margin(0,0,0,0)) +
  facet_wrap(~hh_id, nrow = 1) +
  coord_fixed(ratio = 1) +
  xlim(0, 3) +
  ylim(0, 3) +
  ggtitle("Scenario 1")

# Plot for Scenario 2
plot2 <- ggplot(hh_data2, aes(x = x, y = y)) +
  geom_point(shape = 21, size = 4 * plot_height, color = "black", stroke = 1.2 * plot_height) +
  theme_void(base_size = 10 * plot_height) +
  theme(plot.margin = margin(0,0,0,0)) +
  facet_wrap(~hh_id, nrow = 1) +
  coord_fixed(ratio = 1) +
  xlim(0, 3) +
  ylim(0, 3) +
  ggtitle("Scenario 2")

# Combine both plots vertically using patchwork
print(plot1 | plot2)
```

That said, we can prove that given population size and average person-level household size, there is a minimum number of households given by

\begin{align}
H_{min} = \frac{P}{\text{(Mean HH Size)}_{\text{person}}}
\end{align}

and a max given by

[FILL IN HERE]


# Proof: minimum number of households is given by 
\begin{align}
H_{min} = \frac{P}{\text{(Mean HH Size)}_{\text{person}}}
\end{align}

Notation: Let the mean person-level household size, $\text{(Mean HH Size)}_{\text{person}}$, be indicated in shorthand as $M_{p}$. Let the population be indicated as $P$ and the number of households be indicated as $H$.

Case A:
Consider a specific case where $P = p$ and $M_p = m$, which happens to be a factor of $p$: in other words, there exists a positive integer $i$ such that $m * i = p$. Let us imagine a town configured in this fashion. One (but potentially not the only) configuration consistent with these statistics: $M_p = m$, $P = p$, is that the town has exactly $i$ households, each containing exactly $\frac{p}{i} = m$ members:

[schematic showing this in an example where P = 30, m = 3].

...

this section of the proof ends where I show that there's no possible way to "dissolve" a household and add its contents to other households without pushing the average persn-level household size above $m$.

Case B:
Then I illustrate the same concept even when $i$ is not an integer by creating the "closest square household configuration" where I essentially show that, for example, if m = 2.75, you can configure the population into groups of the nearest integer-size households (2- and 3-person housholds) such that dissolving the contents of any one household and adding it to other households ill push the average person-level household size above $m$.

Thus, the configurations described above give the minimum number of households, $i = p/m$. And, in fact, when $i$ is not an integer, as in Case B, then the true minimum is given by rounding $i$ up to the nearest integer.

# Proof: Maximum number of househodls is given by 
[TBD]

In this section, I show that the sparsest configuraiton of households is given in a case hwere you produce some number of 1-person households and then throw the rest of the population into a remaining large households.

# conclusion

Reiterate the minima and maxima, take it back to the example at the begining and show that the two configurations I listed are actually the two special cases of minima and maxima.
